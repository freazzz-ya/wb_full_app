{% extends 'stock/base.html' %}

{% block title %}–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º - WB Stock Manager{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üìà –û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</h1>
    <div>
        <a href="{% url 'analytics_dashboard' %}" class="btn btn-outline-secondary me-2">
            <i class="fas fa-arrow-left me-2"></i>–ù–∞–∑–∞–¥ –∫ –¥–∞—à–±–æ—Ä–¥—É
        </a>
        <a href="?period=7" class="btn btn-outline-primary">7 –¥–Ω–µ–π</a>
        <a href="?period=30" class="btn btn-outline-primary">30 –¥–Ω–µ–π</a>
    </div>
</div>

{% if error %}
<div class="alert alert-danger border-0">
    <i class="fas fa-exclamation-triangle me-2"></i>{{ error }}
</div>
{% endif %}

{% if report_data and report_data.success %}
<div class="row">
    <div class="col-12 mb-4">
        <div class="card border-0">
            <div class="card-body">
                <h5 class="card-title">üìä –°–≤–æ–¥–∫–∞ –∑–∞ {{ report_data.period_days }} –¥–Ω–µ–π</h5>
                <div class="row text-center">
                    <div class="col-md-3 mb-3">
                        <div class="border rounded p-3">
                            <h4 class="text-primary mb-1">{{ report_data.orders.count }}</h4>
                            <small class="text-muted">–ó–∞–∫–∞–∑–æ–≤</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="border rounded p-3">
                            <h4 class="text-success mb-1">{{ report_data.sales.count }}</h4>
                            <small class="text-muted">–í—ã–∫—É–ø–æ–≤</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="border rounded p-3">
                            <h4 class="text-danger mb-1">{{ report_data.cancellations.count }}</h4>
                            <small class="text-muted">–û—Ç–∫–∞–∑–æ–≤</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="border rounded p-3">
                            <h4 class="text-warning mb-1">{{ report_data.returns.count }}</h4>
                            <small class="text-muted">–í–æ–∑–≤—Ä–∞—Ç–æ–≤</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card border-0 h-100">
            <div class="card-body">
                <h6 class="card-title mb-3">üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h6>
                <div class="list-group list-group-flush">
                    <div class="list-group-item bg-transparent d-flex justify-content-between">
                        <span>–û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤:</span>
                        <strong class="text-primary">{{ report_data.orders.sum|floatformat:2 }} —Ä—É–±.</strong>
                    </div>
                    <div class="list-group-item bg-transparent d-flex justify-content-between">
                        <span>–°—É–º–º–∞ –≤—ã–∫—É–ø–æ–≤:</span>
                        <strong class="text-success">{{ report_data.sales.sum|floatformat:2 }} —Ä—É–±.</strong>
                    </div>
                    <div class="list-group-item bg-transparent d-flex justify-content-between">
                        <span>–ü–æ—Ç–µ—Ä–∏ –æ—Ç –æ—Ç–∫–∞–∑–æ–≤:</span>
                        <strong class="text-danger">{{ report_data.cancellations.sum|floatformat:2 }} —Ä—É–±.</strong>
                    </div>
                    <div class="list-group-item bg-transparent d-flex justify-content-between">
                        <span>–°—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤:</span>
                        <strong class="text-warning">{{ report_data.returns.sum|floatformat:2 }} —Ä—É–±.</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card border-0 h-100">
            <div class="card-body">
                <h6 class="card-title mb-3">üìà –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h6>
                <div class="list-group list-group-flush">
                    <div class="list-group-item bg-transparent">
                        <div class="d-flex justify-content-between mb-2">
                            <span>–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –≤—ã–∫—É–ø—ã:</span>
                            <strong>{{ report_data.conversion_rate|floatformat:1 }}%</strong>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-success" style="width: {{ report_data.conversion_rate }}%"></div>
                        </div>
                    </div>
                    <div class="list-group-item bg-transparent">
                        <div class="d-flex justify-content-between mb-2">
                            <span>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–∞–∑–æ–≤:</span>
                            <strong>{{ report_data.cancellation_rate|floatformat:1 }}%</strong>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-danger" style="width: {{ report_data.cancellation_rate }}%"></div>
                        </div>
                    </div>
                    <div class="list-group-item bg-transparent">
                        <div class="d-flex justify-content-between">
                            <span>–í—ã–∫—É–ø–ª–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤:</span>
                            <strong>{{ report_data.sales.count }} –∏–∑ {{ report_data.orders.count }}</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}